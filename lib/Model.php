<?phpclass Model extends Config{    var $conn         = false;    var $query        = false;    var $numberOfRows = false;    public function Model()    {        if (!$this->conn) {            $this->conn = @mysql_connect(_HOST, _USERNAME, _PASSWORD);            if (!$this->conn) {                die('Not connected : ' . mysql_error());            }            $select_db = @mysql_select_db(_DBNAME, $this->conn);            if (!$select_db) {                die('DB ' . _DBNAME . 'cannot be used' . mysql_error());            }            $qry = 'SET time_zone = "' . _TIME_ZONE . '";';            date_default_timezone_set(_TIME_ZONE);            $this->exec($qry);            $this->initConfigVariables();        }        return $this->conn;    }    public function exec($qry)    {        $this->query = mysql_query($qry, $this->conn);        if (!$this->query) {            return mysql_error();        }        return $this->query;    }    public function insert($qry)    {        $result = $this->exec($qry);        if (!$result) {            return mysql_error();        }        $id = mysql_insert_id($this->conn);        return $id;    }    public function getNumberOfROws()    {        if (!$this->numberOfRows = @mysql_num_rows($this->query)) {            return mysql_error();        }        return $this->numberOfRows;    }    public function fetch($qry, $single_row = false)    {        $result = $this->exec($qry);        $response = array();        if ($result) {            while ($row = mysql_fetch_assoc($result)) {                $response[] = $row;            }            if ($single_row) {                $response = @$response[0];            }        } else {            return $result;        }        return $response;    }    public function initConfigVariables()    {        $qry = "SELECT path,value FROM `config` ";        $result = $this->fetch($qry);        $config = array();        foreach ($result as $row) {            $config[$row['path']] = $row['value'];        }        Template::$configData = $config;    }    public function updateConfigVariable($path, $value)    {        $qry = "update `config` set  value = '$value' where path = '$path'";        $result = $this->exec($qry);        $this->initConfigVariables();    }    public function checkUsernameExist($username)    {        $qry = "SELECT * FROM `users` where username = '$username'";        $result = $this->fetch($qry);        if (count($result)) {            return $result[0];        } else {            return false;        }    }    public function isUserLoggedIn()    {        return Template::getSession('user');    }    public function getLoggedInUser()    {        return Template::getSession('user');    }}